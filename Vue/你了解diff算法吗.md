# 你了解 diff 算法吗

## 介绍一下

diff 算法就是一种同层树节点比较的高效算法，它的特点就是：同层比较，不会跨层级比较，循环从两边向中间靠拢，它的时间复杂度只有 O(n)

像在 vue 中被用于新旧 vnode-tree 的比较，它的宗旨是尽可能的复用原来的DOM，减少dom操作，从而达到提升性能的效果

## 在 vue2 中

利用四个指针，先进行 首首、尾尾、首尾、尾首 的顺序进行比较，寻找未移动的节点

然后创建一个老节点的 keyToIndex 的哈希表，继续遍历新节点并从哈希表中查找到可复用的老节点

最后移除多余老节点和增加新节点

## 在 vue3 中

在一次循环中只有 首首和尾尾 的对比

然后创建一个 新节点在旧节点中位置的映射表，然后根据这个映射表计算出最长递增子序列

序列中的节点代表可以原地复用，其他的新节点移动到正确的位置即可

> 参考：https://segmentfault.com/a/1190000042586883
