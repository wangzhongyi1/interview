# vue中dom-diff原理
- vue中使用双指针的方式来进行dom-diff
    + 有一个老的头指针指向oldVnode的头部，一个老的尾指针指向oldVnode的尾部
    + 还有一个新的头指针指向newVnode的头部，一个新的尾指针指向newVnode的尾部
    + 首先老的头指针和新的头指针所指向的vnode进行比较
        * 看是不是同一个节点，如果是，就将老的头指针往后移，新的头指针也往后移，如果不是同个节点
    + 然后将老的尾指针和新的尾指针所指向的vnode进行比较
        * 如果是同个节点，就把老的尾指针往前移，新的尾指针也往前移，如果不是同个节点
    + 然后将老的头指针和新的尾指针所指向的vnode进行比较
        * 如果是同个节点，就把老的头指针所在的真实dom元素插入到老的尾指针所在的真实dom元素的后面
        * 然后将老的头指针往后移，新的尾指针往前移
        * 如果不是同个节点
    + 然后将老的尾指针和新的头指针所指向的vnode进行比较
        * 如果是同个节点，就将老的尾指针所在的真实dom元素插入到老的头指针所在的真实dom元素的前面
        * 然后将老的尾指针往前移，新的头指针往后移
        * 如果不是同个节点
    + 上面的都没找到，最后用新的头指针指向的vnode到老的vnode队列形成的映射表中去寻找
        * 如果能找到，就将找到的vnode中保存的真实dom元素插入到老的头指针所在真实dom元素的前面，然后所在位置置为空，然后新的头指针往后移
        * 如果不能找到，就直接根据新的头指针指向的vnode来创建真实dom元素，然后插入到老的头指针所在真实dom元素的前面，然后新的头指针往后移

    + 循环结束后
        * 如果老的尾指针大于等于老的头指针，说明需要删除，就把头尾指针之间的元素删除
        * 如果新的尾指针大于等于新的头指针，说明需要新增，就把头尾指针之间的元素添加到老的尾指针所在真实dom元素的后面